{
    "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
    "title": {
      "text": "Australia's Export Trends by Industry and State (2014-2020)",
      "anchor": "middle"
    },
    "width": 800,
    "height": "container",
    "params": [
      {
        "name": "selectedYear",
        "value": 2020
      }
    ],
    "data": {
      "url": "https://raw.githubusercontent.com/mind0002/FIT3179-HomeworkWk10/refs/heads/main/data/exp_industry_state_year.csv"
    },
    "hconcat": [
      {
        "encoding": {
            "x": {
                "field": "Year",
                "type": "temporal",
                "title": "Year"
                },
            "y": {
                "aggregate": "sum",
                "field": "Value($m)",
                "type": "quantitative",
                "title": "Value of Export Goods Value ($m)"
                },
            "color": {
                "condition": {
                    "param": "click",
                    "field":"Industry",
                    "type":"nominal",
                    "legend": null
                },
                "value": "grey"
                },
            "opacity": {
                    "condition": {
                      "param": "click",
                      "value": 1
                    },
                    "value": 0.2
                  }
                },
            "layer": [
              {
                "params": [{
                  "name": "click",
                  "select": {
                    "type": "point",
                    "fields": ["Industry"],
                    "clear": "dbclick"
                  }
                }],
                "mark": {
                  "type": "line", 
                  "strokeWidth": 8, 
                  "point": true, 
                  "stroke": "transparent"
                }, "transform": [
                {
                    "calculate":"year(datum.Year)",
                    "as": "data_year"
                  }
                ],
                "encoding":{
                    "tooltip": [
                    {
                      "field": "Industry",
                        "type": "nominal", 
                        "title": "Industry"
                    },
                    {
                      "field": "data_year",
                      "type": "quantitative",
                      "title": "Year"
                    },
                    {"aggregate": "sum", 
                    "field": "Value($m)", 
                    "type": "quantitative", 
                    "title": "Export Value ($m)"
                    } 
                  ]
                  }
                },
                {
                  "mark": "line"
                },
                {
                  "encoding": 
                  {
                    "x": {
                      "aggregate": "max", 
                      "field": "Year"
                    },
                    "y": {
                      "aggregate":{
                        "argmax": "Year"
                        }, 
                        "field": "Value($m)"
                        }
                  },
                  "layer": [
                    {
                    "mark": {
                      "type": "circle"
                      }
                  }, {
                    "mark": {
                      "type": "text", 
                      "align": "left",
                      "dx": 4
                    },
                    "encoding": {
                      "text": {
                        "field":"Industry",
                          "type": "nominal"
                      }
                    }
                  }
              ]
          }
        ]
      },
      {
        "mark": {
          "type": "bar",
          "tooltip": true
        },
        "transform": [
          {
            "filter": "length(data('click_store')) == 0 || datum.Industry == data('click_store')[0].values[0]"
          },
          {
            "filter": "year(datum.Year) == selectedYear"
          },
          {
            "calculate": "year(datum.Year)",
            "as": "data_year"
          }
        ],
        "encoding": {
          "x": {
            "field": "State",
            "type": "nominal",
            "title": "State"
          },
          "y": {
            "aggregate": "sum",
            "field": "Value($m)",
            "type": "quantitative",
            "title": "Export Value ($m)"
          },
          "color": {
            "value": "#41ab5d"
          },
          "tooltip": [
            {"field": "data_year", "type": "nominal", "title": "Year"},
            {"field": "State", "type": "nominal", "title": "State"},
            {"aggregate": "sum", "field": "Value($m)", "type": "quantitative", "title": "Export Value ($m)"}
          ]
        }
      }
    ], "spacing": 75,
    "config": {
      "view": {
        "stroke": null
      },
      "axis": {
        "labelFont": "Afacad Flux",
        "titleFont": "Afacad Flux",
        "titleFontSize": 14,
        "labelFontSize": 14
      },
      "legend": {
        "labelFont": "Afacad Flux",
        "titleFont": "Afacad Flux",
        "titleFontSize": 14,
        "labelFontSize": 14
      },
      "header": {
        "labelFont": "Afacad Flux",
        "titleFont": "Afacad Flux"
      },
      "title": {
        "font": "Afacad Flux",
        "fontSize": 18,
        "fontWeight": 600
      }
    }
  }
  